"use strict";(globalThis.webpackChunksurerank=globalThis.webpackChunksurerank||[]).push([[307,322],{1455:e=>{e.exports=window.wp.apiFetch},27723:e=>{e.exports=window.wp.i18n},47143:e=>{e.exports=window.wp.data},51609:e=>{e.exports=window.React},66087:e=>{e.exports=window.lodash},75795:e=>{e.exports=window.ReactDOM},86087:e=>{e.exports=window.wp.element},91167:(e,t,a)=>{var n=a(51609),s=a(75795);const r=window.wp.compose;var l=a(86087),i=a(47143),c=a(1671),o=a(9607),u=a(66221),p=a(22343),m=a(60443),d=a(30758),g=a(88029),h=a(30732);const k=e=>t=>{const a=(0,i.useSelect)((e=>{const t=e("core/editor");return{postTitle:t.getEditedPostAttribute("title"),postExcerpt:t.getEditedPostAttribute("excerpt")}}),[]);return(0,l.useEffect)((()=>{(0,i.dispatch)(c.E).updatePostDynamicData({title:a.postTitle,excerpt:a.postExcerpt})}),[a.postTitle,a.postExcerpt]),(0,n.createElement)(e,{...t})},f=e=>t=>{const a=(e,t)=>{const a=(0,i.dispatch)(c.E);"content"===e&&(t=(0,o.XY)(t)),a.updatePostDynamicData({[e]:t})};return(0,l.useEffect)((()=>{const e=document.querySelector("textarea[name='content']#content");e&&e.addEventListener("input",(e=>{a("content",e.target.value)}));const t=document.querySelector("iframe#content_ifr");t&&t.contentDocument.body.addEventListener("input",(e=>{a("content",e.target.innerHTML)}));const n=document.querySelector("textarea[name='excerpt']#excerpt");n&&n.addEventListener("input",(e=>{a("excerpt",e.target.value)}));const s=document.querySelector("input[name='post_title']#title");return s&&s.addEventListener("input",(e=>{a("title",e.target.value)})),()=>{e&&e.removeEventListener("input",(e=>{a("content",e.target.value)})),t&&t.contentDocument.body.removeEventListener("input",(e=>{a("content",e.target.innerHTML)})),n&&n.removeEventListener("input",(e=>{a("excerpt",e.target.value)})),s&&s.removeEventListener("input",(e=>{a("title",e.target.value)}))}}),[]),(0,n.createElement)(e,{...t})};var _=a(96404),b=a(27723),E=a(12395),y=a(76016),v=a(71087),w=a(65650),x=a(97213),C=a(94879),N=a(61456),S=a(64506);const A=(e,t="")=>{if(!e)return;let a={};return"richSelect"===t&&(a=[]),Object.values(e).forEach((e=>{Object.keys(e).forEach((n=>{switch(t){case"richSelect":a.push({value:n,label:e[n].label,title:"%"+n+"%",description:e[n].description});break;case"detailed":a[n]=e[n];break;default:a[n]=e[n].value}}))})),a},D=({postMetaData:e,updatePostMetaData:t,globalDefaults:a})=>{var s,r;const{variables:u,postDynamicData:p,title:m,description:d}=(0,i.useSelect)((e=>{const t=e(c.E);return{variables:t?.getVariables(),postDynamicData:t?.getPostDynamicData(),title:t?.getPostSeoMeta()?.page_title,description:t?.getPostSeoMeta()?.page_description}}),[]),g=a,h=(0,l.useRef)(null),k=(0,l.useRef)(null),f=(a,n)=>{e[a]!==n&&t({[a]:n})},_=A(u),E=surerank_seo_popup?.site_icon_url?surerank_seo_popup?.site_icon_url:"",D=(0,S.A)(m||g.page_title,_,p),P=(0,S.A)(d||g?.page_description,_,p),M=(0,o.EJ)(D,y.qt),L=(0,o.EJ)(P,y.UM),z=(0,S.A)(m,_,p),O=(0,S.A)(d,_,p),T=(()=>{const e=()=>{if(!wp?.data?.select("core/editor"))return"";const{getPermalink:e,isCurrentPostPublished:t}=wp.data.select("core/editor"),a=e();return t()&&a||a&&!a?.includes("auto-draft")?a:""},[t,a]=(0,l.useState)(e());return wp.data.subscribe((()=>{const n=e();n&&n!==t&&a(n)})),t})(),R=(0,l.useMemo)((()=>/page_id=|p=/.test(_?.permalink)&&T?T:_?.permalink),[_?.permalink,T]);return(0,n.createElement)("div",{className:"flex flex-col gap-2"},(0,n.createElement)("div",{className:"space-y-2.5 p-2 px-0"},(0,n.createElement)("div",{className:"flex items-center justify-between gap-10"},(0,n.createElement)("div",{className:"flex items-center justify-start gap-1"},(0,n.createElement)(v.A,{tag:"span",size:"sm",className:"space-x-0.5"},(0,n.createElement)("span",null,(0,b.__)("Search Engine Preview","surerank"))),(0,n.createElement)(C.$w,{content:(0,b.__)("View a preview of how your page may appear in search engine results. This preview is for guidance only and might not exactly match how search engines display your content.","surerank"),placement:"top",arrow:!0,className:"z-[99999]"},(0,n.createElement)(x.A,{className:"size-4 text-icon-secondary"})))),(0,n.createElement)(N.A,{siteTitle:_?.site_name,faviconURL:E,title:M,description:L,permalink:(0,o.jP)(R,65),deviceType:"desktop"})),(0,n.createElement)("div",{className:"space-y-1.5 p-2"},(0,n.createElement)("div",{className:"flex items-center justify-start gap-1"},(0,n.createElement)(v.A,{tag:"span",size:"sm",className:"space-x-0.5"},(0,n.createElement)("span",null,(0,b.__)("Search Engine Title","surerank"))),(0,n.createElement)("span",{className:"text-xs leading-4 font-normal text-field-helper"},(0,n.createElement)("span",{className:(0,o.cn)({"text-text-error":z?.length>y.qt})},null!==(s=z?.length)&&void 0!==s?s:0),"/ ",y.qt)),(0,n.createElement)(w.A,{key:"title",ref:h,by:"label",defaultValue:(0,o.pk)(e.page_title||g.page_title,y.Op,"value"),trigger:"@",options:y.Op,onChange:e=>{f("page_title",(0,o.P3)(e.toJSON()))},placeholder:""}),(0,n.createElement)("span",{className:"block text-xs leading-4 font-normal text-field-helper"},(0,b.__)("Type @ to view variable suggestions","surerank"))),(0,n.createElement)("div",{className:"space-y-1.5 p-2"},(0,n.createElement)("div",{className:"flex items-center justify-start gap-1"},(0,n.createElement)(v.A,{tag:"span",size:"sm",className:"space-x-0.5"},(0,n.createElement)("span",null,(0,b.__)("Search Engine Description","surerank"))),(0,n.createElement)("span",{className:"text-xs leading-4 font-normal text-field-helper"},(0,n.createElement)("span",{className:(0,o.cn)({"text-text-error":O?.length>y.UM})},null!==(r=O?.length)&&void 0!==r?r:0),"/",y.UM)),(0,n.createElement)(w.A,{ref:k,className:"!min-h-32 [&+div]:items-start [&+div]:pt-1",by:"label",trigger:"@",defaultValue:(0,o.pk)(e?.page_description||g?.page_description,y.Op,"value"),options:y.Op,onChange:e=>{f("page_description",(0,o.P3)(e.toJSON()))},placeholder:"",maxLength:y.x8}),(0,n.createElement)("span",{className:"block text-xs leading-4 font-normal text-field-helper"},(0,b.__)("Type @ to view variable suggestions","surerank"))))};var P=a(74443),M=a(86777);const L=(0,r.compose)((0,i.withSelect)((e=>{var t,a;const n=e(c.E),s=null!==(t=null!==(a=e("core/editor")?.getPermalink())&&void 0!==a?a:surerank_seo_popup?.link)&&void 0!==t?t:"";return{postMetaData:n.getPostSeoMeta(),canonicalURLPlaceholder:s,globalDefaults:n.getGlobalDefaults()}})),(0,i.withDispatch)((e=>{const t=e(c.E);return{setMetaData:e=>t.updatePostMetaData(e)}})))((({postMetaData:e,setMetaData:t,canonicalURLPlaceholder:a,globalDefaults:s})=>{var r,l;const i=null!==(r=null!==(l=surerank_seo_popup?.post_type)&&void 0!==l?l:wp?.data?.select("core/editor")?.getCurrentPostType())&&void 0!==r?r:"post",c=e?.post_no_index,o=e?.post_no_follow,u=e?.post_no_archive;let p={};if(""===c&&""===o&&""===u){const e=void 0!==s?.no_index?s.no_index:[],t=void 0!==s?.no_follow?s.no_follow:[],a=void 0!==s?.no_archive?s.no_archive:[];e?.includes(i)&&(p={...p,post_no_index:"yes"}),t?.includes(i)&&(p={...p,post_no_follow:"yes"}),a?.includes(i)&&(p={...p,post_no_archive:"yes"})}return"yes"===c&&(p={...p,post_no_index:"yes"}),"yes"===o&&(p={...p,post_no_follow:"yes"}),"yes"===u&&(p={...p,post_no_archive:"yes"}),(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"p-2 pl-0 space-y-2"},(0,n.createElement)("div",{className:"flex items-center justify-start gap-1"},(0,n.createElement)(v.A,{as:"p",size:"sm"},(0,b.__)("Robot Instructions","surerank")," ",(0,n.createElement)(C.Nr,{content:(0,b.__)("These settings help search engines understand how to treat your page in search results. Enabling \u2018No Index\u2019 will prevent the page from appearing in search results. \u2018No Follow\u2019 tells search engines not to follow any links on the page, and \u2018No Archive\u2019 prevents search engines from storing a cached version of the page.","surerank")}))),(0,n.createElement)("div",{className:"flex flex-col gap-2 items-start"},y.vr.map((e=>(0,n.createElement)(P.A,{key:e.id,size:"sm",label:{heading:(0,n.createElement)("div",{className:"flex items-center gap-1"},e.label,(0,n.createElement)(C.Nr,{content:e.description}))},checked:"yes"===p[e.id],onChange:a=>{return n=e.id,s=a,p={...p,[n]:s?"yes":"no"},void t(p);var n,s}}))))),(0,n.createElement)("div",{className:"space-y-2 pt-2 px-2 pl-0"},(0,n.createElement)(v.A,{htmlFor:"canonical-url",size:"sm",className:"gap-1"},(0,b.__)("Canonical URL","surerank"),(0,n.createElement)(C.Nr,{content:(0,b.__)("The Canonical URL tells search engines which version of a page should be indexed to avoid duplicate content issues. Leave blank to let SureRank set it automatically.","surerank")})),(0,n.createElement)(M.A,{id:"canonical-url",type:"text",size:"md",className:"[&_input]:m-0",value:e.canonical_url,onChange:e=>(e=>{t({canonical_url:e})})(e),placeholder:a})))}));var z=a(13739),O=a(1839),T=a(28177),R=a(98583),$=a(22895);const I=({onConfirm:e,confirmText:t=(0,b.__)("Remove","surerank"),cancelText:a=(0,b.__)("Cancel","surerank"),children:s,className:r,...i})=>{const[c,u]=(0,l.useState)(!1),p=e=>{e.preventDefault(),e.stopPropagation()},m=(0,n.createElement)("div",{className:"flex gap-2 items-center"},(0,n.createElement)(g.A,{size:"xs",variant:"outline",onClick:e=>{p(e),u(!1)},"aria-label":(0,b.__)("Cancel","surerank")},a),(0,n.createElement)(g.A,{size:"xs",className:"focus:[box-shadow:none] bg-button-danger hover:bg-button-danger-hover outline-button-danger hover:outline-button-danger-hover",onClick:t=>{p(t),e(),u(!1)},destructive:!0,"aria-label":(0,b.__)("Confirm","surerank")},t));return(0,n.createElement)(C.$w,{className:(0,o.cn)("w-fit p-1.5 rounded shadow-md border border-solid border-border-subtle [&>svg]:fill-border-subtle",r),content:m,open:c,setOpen:u,variant:"light",arrow:!0,...i},(0,l.cloneElement)(s,{onClick:e=>{p(e),u((e=>!e))}}))},j=({postMetaData:e,globalDefaults:t,updatePostMetaData:a})=>{const[s,r]=(0,l.useState)(!1),[i,c]=(0,l.useState)(""),[u,p]=(0,l.useState)(""),[m,d]=(0,l.useState)(null),g=surerank_seo_popup?.default_schemas||{},k=Object.entries(g).map((([e,t])=>({id:e,...t}))),f=e.schemas?e.schemas:t.schemas||{}||{},_=surerank_seo_popup?.schema_type_data||{},y=surerank_seo_popup?.schema_type_options||{},w=(0,l.useMemo)((()=>Object.entries(surerank_seo_popup?.schema_variables||{}).map((([e,t])=>({value:e,label:t})))),[]),N=e=>e.reduce(((e,t)=>("Group"===t.type&&t.fields?e[t.id]=N(t.fields):void 0!==t.std&&(e[t.id]=t.std),e)),{}),S=e=>{const t={};return Object.entries(e).forEach((([e,a])=>{const{show_on:n,not_show_on:s,...r}=a,l={...r,parent:!0};t[e]=l})),t};(0,l.useEffect)((()=>{const e={};if(Object.entries(f).forEach((([t,a])=>{const n=a.fields||{},s=N(_[a.title]||[]),r={...n,...s};0===Object.keys(n).length&&(r["@type"]=a?.type||"",e[t]={...a,fields:r})})),Object.keys(e).length>0){const t=S({...f,...e});JSON.stringify(t)!==JSON.stringify(f)&&a({schemas:t})}}),[f,_,a]);const A=(e,t)=>f[e]?.fields?.[t]||"",D=(e,t,n)=>{if(((e,t,n)=>{const s={...f,[e]:{...f[e],fields:{...f[e].fields,[t]:n}}},r=S(s);a({schemas:r})})(e,t,n),"@type"===t){const t={...f};t[e].type=n,t[e].fields["@type"]=n,a({schemas:t})}};return(0,n.createElement)("div",{className:"pt-2 gap-2"},(0,n.createElement)("div",{className:"flex items-center mb-4.5 -mt-0.5"},(0,n.createElement)(h.E,{size:14,weight:500,color:"label"},(0,b.__)("Schemas in Use","surerank"))),(0,n.createElement)("div",{className:(0,o.cn)("w-full bg-background-secondary flex flex-col items-center justify-center rounded p-1")},Object.entries(f).length>0?(0,n.createElement)(E.Ay,{type:"simple",iconType:"arrow",className:"w-full space-y-1",autoClose:!1},Object.entries(f).map((([e,t])=>(0,n.createElement)(E.Ay.Item,{key:e,value:e,className:"bg-background-primary rounded-md",defaultExpanded:e===m},(0,n.createElement)(E.Ay.Trigger,{iconType:"arrow",className:"hover:bg-background-primary rounded-md flex justify-between items-center [&>div]:w-full p-2 gap-2 [&>svg]:size-4 cursor-pointer"},(0,n.createElement)("span",{className:"text-base font-normal text-text-primary leading-6 ml-1"},t.title),(0,n.createElement)(I,{onConfirm:()=>(e=>{const t={...f};delete t[e];const n=S(t);a({schemas:n})})(e),placement:"bottom",offset:{mainAxis:8,crossAxis:-28}},(0,n.createElement)("div",{className:"inline-flex ml-auto",role:"button",tabIndex:0},(0,n.createElement)(O.A,{className:"size-3.5 text-icon-secondary cursor-pointer"})))),(0,n.createElement)(E.Ay.Content,null,(0,n.createElement)("div",{className:"mt-3 space-y-4"},(e=>{const t=_[f[e]?.title]||[];return 0===t.length||t.every((e=>"Hidden"===e.type||"schema_name"===e.id))?R.E:t.map((t=>"Hidden"===t.type||"SchemaDocs"===t.type?null:t.show||t.required?(0,n.createElement)("div",{key:t.id,className:"flex flex-col items-start justify-start gap-1.5 w-full p-1"},(0,n.createElement)("div",{className:"flex items-center gap-1.5"},(0,n.createElement)(v.A,{tag:"span",size:"sm",required:t.required},t.label),t.tooltip&&(0,n.createElement)(C.$w,{content:t.tooltip,placement:"top",arrow:!0,className:"z-[99999]"},(0,n.createElement)(x.A,{className:"size-4 text-icon-secondary",title:t.tooltip}))),(0,n.createElement)("div",{className:"flex items-center gap-1.5 w-full"},t.cloneable?(0,T.OH)({field:t,schemaType:f[e].type,getFieldValue:t=>A(e,t),onFieldChange:(t,a)=>D(e,t,a),variableSuggestions:w,renderAsGroupComponent:!0}):(0,T.Yi)({field:t,schemaType:f[e].type,getFieldValue:t=>A(e,t),onFieldChange:(t,a)=>D(e,t,a),variableSuggestions:w,renderAsGroupComponent:!0}))):null))})(e))))))):(0,n.createElement)(z.A,{className:"w-full shadow-none",content:(0,b.__)("No schemas configured.","surerank"),variant:"info"})),(0,n.createElement)("div",{className:"w-full mt-6 rounded"},(0,n.createElement)($.A,{selectedSchema:i,setSelectedSchema:c,selectedType:u,setSelectedType:p,schemaTypeOptions:y,defaultSchemas:k,handleAddSchema:()=>{const e=(0,R.l)(),t={title:i,type:u,show_on:{rules:[],specific:[],specificText:[]},fields:{}},n={...f,[e]:t},s=S(n);a({schemas:s}),d(e),r(!1),c(""),p("")},isModalOpen:s,closeModal:()=>r(!1)})))},q=({postMetaData:e,updatePostMetaData:t,globalDefaults:a})=>(0,n.createElement)(E.Ay,{autoClose:!0,defaultValue:"general",type:"boxed",className:"bg-background-secondary space-y-1 p-1 rounded-lg"},(0,n.createElement)(E.Ay.Item,{value:"general",className:"bg-background-primary border-none"},(0,n.createElement)(E.Ay.Trigger,{className:"text-base [&>svg]:size-5 pr-2 pl-3 py-3"},(0,b.__)("General","surerank")),(0,n.createElement)(E.Ay.Content,null,(0,n.createElement)(D,{postMetaData:e,updatePostMetaData:t,globalDefaults:a}))),(0,n.createElement)(E.Ay.Item,{value:"advanced",className:"bg-background-primary border-none"},(0,n.createElement)(E.Ay.Trigger,{className:"text-base [&>svg]:size-5 pr-2 pl-3 py-3"},(0,b.__)("Advanced","surerank")),(0,n.createElement)(E.Ay.Content,null,(0,n.createElement)(L,{postMetaData:e,updatePostMetaData:t,globalDefaults:a}))),(0,n.createElement)(E.Ay.Item,{value:"schema",className:"bg-background-primary border-none"},(0,n.createElement)(E.Ay.Trigger,{className:"text-base [&>svg]:size-5 pr-2 pl-3 py-3"},(0,b.__)("Schema","surerank")),(0,n.createElement)(E.Ay.Content,null,(0,n.createElement)(j,{postMetaData:e,updatePostMetaData:t,globalDefaults:a}))));var U=a(19781),F=a(82313),V=a(38502),G=a(71149),J=a(68458);const B=[{label:"Facebook",icon:F.A,tabSlug:"facebook"},{label:"X",icon:G.B0,tabSlug:"twitter"}],W=({postMetaData:e,updatePostMetaData:t,globalDefaults:a})=>{const{variables:s,postDynamicData:r}=(0,i.useSelect)((e=>{const{getVariables:t,getPostDynamicData:a}=e(c.E);return{variables:t(),postDynamicData:a()}}),[]),u=a,[m,d]=(0,l.useState)("facebook"),g=(0,l.useCallback)(((t,a)=>{let n=m;return"twitter"===m&&e?.twitter_same_as_facebook&&(n="facebook"),e?.[`${n}_${t}`]||a?.[`${n}_${t}`]}),[m,e,s,r]),h=A(s),k=(0,o.EJ)((0,S.A)(g("title",u),h,r),null),f=(0,o.EJ)((0,S.A)(g("description",u),h,r),78),_=e?.auto_generated_og_image?e?.auto_generated_og_image:u?.fallback_image,N=g("image_url",u)?g("image_url",u):_;let D=e?.[`${m}_image_url`]?e?.[`${m}_image_url`]:N;"twitter"===m&&e?.twitter_same_as_facebook&&(D=e?.facebook_image_url||_);const P=!!e?.[`${m}_image_url`],L=()=>{t({[`${m}_image_url`]:"",[`${m}_image_id`]:""})},z=(0,l.useRef)(null),O=(0,l.useRef)(null),T=(a,n)=>{e[a]!==n&&t({[a]:n})},R=a=>{a.preventDefault();const n=wp.media({title:"Select Image",button:{text:"Use this image"},multiple:!1});n.on("select",(()=>{const a=n.state().get("selection").first().toJSON();t({...e,[`${m}_image_url`]:a.url,[`${m}_image_id`]:a.id})})),n.open()};return(0,n.createElement)("div",{className:"flex flex-col gap-2 max-h-full w-full"},(0,n.createElement)(E.Ay,{autoClose:!0,defaultValue:"facebook",collapsible:!1,type:"boxed",className:"bg-background-secondary space-y-1 rounded-lg w-full"},B.map((({label:t,tabSlug:r})=>{return(0,n.createElement)(E.Ay.Item,{key:r,value:r,className:"bg-background-primary border-none w-full"},(0,n.createElement)(E.Ay.Trigger,{className:"text-base [&>svg]:size-5 pr-2 pl-3 py-3 flex items-center gap-2 w-full",onClick:()=>{d("twitter"===r?"twitter":"facebook")}},t),(0,n.createElement)(E.Ay.Content,null,(0,n.createElement)(p.P.div,{key:r,className:"flex-1 flex flex-col gap-2 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2}},"twitter"===r&&(0,n.createElement)("div",{className:"flex items-center gap-3 p-2"},(0,n.createElement)(U.Ay,{id:"facebook_same_as_twitter",name:"facebook_same_as_twitter",size:"sm",defaultValue:!!e?.twitter_same_as_facebook,onChange:e=>{T("twitter_same_as_facebook",!!e&&"1")}}),(0,n.createElement)(v.A,{htmlFor:"facebook_same_as_twitter",size:"sm"},(0,b.__)("Use Data from Facebook Tab","surerank"))),(l="twitter"===r&&!!e?.twitter_same_as_facebook,i=(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"p-2 space-y-1.5"},(0,n.createElement)("div",{className:"flex items-center gap-1"},(0,n.createElement)(v.A,{tag:"span",size:"sm"},(0,b.__)("Social Image","surerank")),(0,n.createElement)(C.$w,{content:(0,b.__)("Upload at least 600x315px image. Recommended size is 1200x630px.","surerank"),placement:"top",arrow:!0,className:"z-[99999]"},(0,n.createElement)(x.A,{className:"size-4 text-icon-secondary"}))),(0,n.createElement)(M.A,{className:"m-0 [&>input]:m-0 [&>input]:transition-colors [&>input]:duration-150 [&>input]:ease-in-out",type:"file",size:"md",onClick:R}),P&&(0,n.createElement)(J.A,{imageId:e?.[`${m}_image_id`],onRemove:L})),(0,n.createElement)("div",{className:"space-y-1.5 p-2"},(0,n.createElement)("div",{className:"flex items-center justify-between gap-1"},(0,n.createElement)(v.A,{tag:"span",size:"sm",className:"space-x-0.5"},(0,n.createElement)("span",null,(0,b.__)("Social Title","surerank")))),(0,n.createElement)(w.A,{ref:z,by:"label",defaultValue:(0,o.pk)(e?.[`${r}_title`],y.Op,"value"),trigger:"@",options:y.Op,onChange:e=>{T(`${r}_title`,(0,o.P3)(e.toJSON()))},placeholder:""}),(0,n.createElement)("span",{className:"block text-xs leading-4 font-normal text-field-helper"},(0,b.__)("Type @ to view variable suggestions","surerank"))),(0,n.createElement)("div",{className:"space-y-1.5 p-2"},(0,n.createElement)("div",{className:"flex items-center justify-between gap-1"},(0,n.createElement)(v.A,{tag:"span",size:"sm",className:"space-x-0.5"},(0,n.createElement)("span",null,(0,b.__)("Social Description","surerank")))),(0,n.createElement)(w.A,{ref:O,className:"!min-h-32 [&+div]:items-start [&+div]:pt-1",by:"label",defaultValue:(0,o.pk)(e?.[`${r}_description`],y.Op,"value"),options:y.Op,onChange:e=>{T(`${r}_description`,(0,o.P3)(e.toJSON()))},trigger:"@",placeholder:"",maxLength:y.x8}),(0,n.createElement)("span",{className:"block text-xs leading-4 font-normal text-field-helper"},(0,b.__)("Type @ to view variable suggestions","surerank")))),l?null:"function"===typeof i?i():i),(0,n.createElement)("div",{className:"p-2 space-y-2"},(0,n.createElement)(v.A,{tag:"span",size:"sm"},(0,b.sprintf)((0,b.__)("%s Preview","surerank"),"facebook"===r?"Facebook":"X")),(0,n.createElement)(V.A,{type:r,title:k,description:f,imageURL:D,twitterLargePreview:"twitter"===r&&"summary_large_image"===a?.twitter_card_type,siteURL:s?.site?.site_url?.value?.replace(/(^\w+:|^)\/\//,""),hideRemoveButton:!0})))));var l,i}))))},X=({postMetaData:e,updatePostMetaData:t,globalDefaults:a})=>(0,n.createElement)("div",{className:"p-2 gap-2"},(0,n.createElement)("div",{className:"w-full bg-background-secondary flex flex-col items-center justify-center rounded p-1"},(0,n.createElement)(W,{postMetaData:e,updatePostMetaData:t,globalDefaults:a})));var H=a(29767);const Y=({tab:e="general"})=>{if("advanced"===e){const e=3;return(0,n.createElement)("div",{className:"w-full p-4 space-y-5"},(0,n.createElement)("div",{className:"space-y-2"},(0,n.createElement)("div",{className:"w-full flex items-center gap-2"},(0,n.createElement)(H.A,{variant:"rectangular",className:"w-32 h-4"}),(0,n.createElement)(H.A,{variant:"circular",className:"size-5"})),(0,n.createElement)("div",{className:"space-y-4"},Array.from({length:e}).map(((e,t)=>(0,n.createElement)("div",{key:t,className:"flex items-start gap-2"},(0,n.createElement)(H.A,{variant:"rectangular",className:"size-5"}),(0,n.createElement)("div",{className:"space-y-2"},(0,n.createElement)(H.A,{variant:"rectangular",className:(0,o.cn)("w-44 h-5",t%2===0&&"w-52")}),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-full h-4"}))))))),(0,n.createElement)("div",{className:"w-full p-1 space-y-1.5"},(0,n.createElement)("div",{className:"w-full flex items-center gap-2"},(0,n.createElement)(H.A,{variant:"rectangular",className:"w-32 h-4"}),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-5 h-4"})),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-full h-12"}),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-full h-3"})))}const t="social"===e?2:1;return(0,n.createElement)("div",{className:"w-full space-y-2 p-2"},"social"===e&&(0,n.createElement)("div",{className:"w-full p-1"},(0,n.createElement)(H.A,{variant:"rectangular",className:"w-full h-14"})),(0,n.createElement)("div",{className:"w-full p-1 space-y-2"},(0,n.createElement)("div",{className:"w-full flex items-center justify-between"},(0,n.createElement)(H.A,{variant:"rectangular",className:"w-32 h-4"}),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-10 h-5"})),(0,n.createElement)(H.A,{variant:"rectangular",className:(0,o.cn)("w-full h-40",{"h-48":"social"===e})})),Array.from({length:t}).map(((e,t)=>(0,n.createElement)("div",{key:t,className:"w-full p-1 space-y-1.5"},(0,n.createElement)("div",{className:"w-full flex items-center gap-2"},(0,n.createElement)(H.A,{variant:"rectangular",className:"w-32 h-4"}),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-5 h-4"})),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-full h-12"}),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-full h-3"})))),(0,n.createElement)("div",{className:"w-full p-1 space-y-1.5"},(0,n.createElement)("div",{className:"w-full flex items-center gap-2"},(0,n.createElement)(H.A,{variant:"rectangular",className:"w-32 h-4"}),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-5 h-4"})),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-full h-32"}),(0,n.createElement)(H.A,{variant:"rectangular",className:"w-full h-3"})))};var K=a(54429);const Z=[{label:(0,b.__)("Meta","surerank"),slug:"meta"},{label:(0,b.__)("Social","surerank"),slug:"social"}];let Q=e=>e;"block"===surerank_seo_popup?.editor_type?Q=k:"classic"===surerank_seo_popup?.editor_type&&(Q=f);const ee=(0,r.compose)((0,i.withSelect)((e=>{const t=e(c.E);return{postMetaData:t.getPostSeoMeta(),initialized:t.getMetaboxState(),globalDefaults:t.getGlobalDefaults()}})),(0,i.withDispatch)((e=>{const t=e(c.E);return{updatePostMetaData:e=>t.updatePostMetaData(e)}})),Q)((0,l.memo)((e=>{const{postMetaData:t,updatePostMetaData:a,initialized:s,globalDefaults:r}=e,[i,c]=(0,l.useState)("meta");let o=null;switch(i){case"meta":o=(0,n.createElement)(q,{postMetaData:t,updatePostMetaData:a,globalDefaults:r});break;case"social":o=(0,n.createElement)(X,{postMetaData:t,updatePostMetaData:a,globalDefaults:r});break;default:o=null}return s||(o=(0,n.createElement)(Y,{tab:i})),(0,n.createElement)(l.Fragment,null,(0,n.createElement)("div",{className:"p-2"},(0,n.createElement)(K.Ay.Group,{className:"w-full",size:"md",variant:"rounded",activeItem:i,onChange:({event:e,value:{slug:t}})=>{e.preventDefault(),e.stopPropagation(),c(t)}},Z.map((({label:e,slug:t})=>(0,n.createElement)(K.Ay.Tab,{key:e,slug:t,text:e,className:"text-sm"}))))),(0,n.createElement)(p.P.div,{key:i,className:"flex flex-col gap-2 flex-1 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2}},o))})));var te=a(48697),ae=a(66087);const ne=({id:e,title:t,status:a,description:n,data:s,showImages:r})=>({id:e,title:t,status:a,description:n,data:s,showImages:r}),se=async()=>{if(window?.tinymce?.editors?.length)return document.querySelector("#set-post-thumbnail>img");const e=window?.wp?.data?.select("core/editor");if(e&&"function"===typeof e.getEditedPostContent){const n=e.getEditedPostAttribute("featured_media");if(n){var t,a;const e=await new Promise((e=>{const t=wp.media.attachment(n);"function"===typeof t.fetch&&t.fetch().then((t=>e(t))).catch((()=>{e({})}))}));return{alt:null!==(t=e?.alt)&&void 0!==t?t:"",src:null!==(a=e?.url)&&void 0!==a?a:""}}}},re=async e=>{let t=[];const a=await se();if(a&&t.push(a),t=[...t,...Array.from(e.querySelectorAll("img"))?.filter((e=>e?.src))],0===t.length)return;const n=t.filter(Boolean).filter((e=>!e?.alt?.trim()));return ne(0===n.length?{id:"image_alt_text",title:(0,b.__)("All images on this page have alt text attributes.","surerank"),status:"success"}:{id:"image_alt_text",title:(0,b.__)("One or more images on this page are missing alt text attributes.","surerank"),status:"warning",data:Array.from(new Set(n.map((e=>e.src)))),showImages:!0})},le=async e=>{const t=!!await se(),a=e.querySelectorAll("img, figure img, figure picture, figure.is-type-photo").length>0||t,n=e.querySelectorAll("video, figure.is-type-video").length>0;return ne(a||n?!a&&n?{id:"media_present",title:(0,b.__)("This page includes video(s) but no images.","surerank"),status:"warning"}:{id:"media_present",title:(0,b.__)("This page includes images or videos to enhance content.","surerank"),status:"success"}:{id:"media_present",title:(0,b.__)("No images or videos found on this page.","surerank"),status:"warning"})},ie=e=>{const t=Array.from(e.querySelectorAll("a[href]"));return 0===t.length?ne({id:"links_present",title:(0,b.__)("No links found on this page.","surerank"),status:"warning"}):t.length>0?ne({id:"links_present",title:(0,b.__)("Links are present on this page.","surerank"),status:"success"}):void 0},ce=e=>{const t=e.length,a=(0,b.sprintf)((0,b.__)("Page URL is longer than %s characters and may affect SEO and readability.","surerank"),y.X);return ne(t>y.X?{id:"url_length",title:a,status:"warning"}:{id:"url_length",title:(0,b.__)("Page URL is short and SEO-friendly.","surerank"),status:"success"})},oe=e=>{const t=Array.from(e.querySelectorAll("h2, h3, h4, h5, h6"));return ne(t.length?{id:"h2_subheadings",title:(0,b.__)("Page contains at least one subheading.","surerank"),status:"success"}:{id:"h2_subheadings",title:(0,b.__)("Page does not contain at least one subheading.","surerank"),status:"warning"})},ue=e=>ne(e?e.length>60?{id:"search_engine_title",title:(0,b.sprintf)((0,b.__)("Search engine title exceeds %1$d characters.","surerank"),y.qt),status:"warning"}:{id:"search_engine_title",title:(0,b.sprintf)((0,b.__)("Search engine title is present and under %1$d characters.","surerank"),y.qt),status:"success"}:{id:"search_engine_title",title:(0,b.__)("Search engine title is missing on the page.","surerank"),status:"error"}),pe=e=>ne(e?e.length>160?{id:"search_engine_description",title:(0,b.sprintf)((0,b.__)("Search engine description exceeds %1$d characters.","surerank"),y.UM),status:"warning"}:{id:"search_engine_description",title:(0,b.sprintf)((0,b.__)("Search engine description is present and under %1$d characters.","surerank"),y.UM),status:"success"}:{id:"search_engine_description",title:(0,b.__)("Search engine description is missing on the page.","surerank"),status:"warning"}),me=()=>{var e;const t=null!==(e=window?.surerank_globals?.open_graph_tags)&&void 0!==e&&e;return ne(t?{id:"open_graph_tags",title:(0,b.__)("Open Graph tags are not present on the page.","surerank"),status:"suggestion"}:{id:"open_graph_tags",title:(0,b.__)("Open Graph tags are present on the page.","surerank"),status:"success"})};var de=a(1455),ge=a.n(de);const he=new Map,ke=e=>e?.length?e.filter((e=>!he.get(e))):[],fe=e=>ne(e?{id:"canonical_url",title:(0,b.__)("Canonical tag is present on the page.","surerank"),status:"success"}:{id:"canonical_url",title:(0,b.__)("Canonical tag is not present on the page.","surerank"),status:"warning"}),_e=async({postId:e,userAgent:t,url:a,allLinks:n})=>await ge()({path:"/surerank/v1/checks/broken-link",method:"POST",data:{post_id:e,user_agent:t,url:a,urls:n}});var be=a(14060);const Ee=async(e,t,a,n,s,r)=>{const l=n(c.E).getVariables()?.post?.ID?.value||0;e(!0);try{const e=await ge()({path:`/surerank/v1/page-seo-checks?post_id=${l}`,method:"GET"}),n=(0,o.mT)(e?.checks),s=e?.checks?.all_links||[];t((e=>{const t=new Set(s),a=new Set;return e.brokenLinks.forEach((e=>{t.has(e)&&a.add(e)})),{isChecking:s.length>0,checkedLinks:new Set,brokenLinks:a,allLinks:s}}));const r={badChecks:n.badChecks.filter((e=>"broken_links"!==e.id)),fairChecks:n.fairChecks.filter((e=>"broken_links"!==e.id)),suggestionChecks:n.suggestionChecks.filter((e=>"broken_links"!==e.id)),passedChecks:n.passedChecks.filter((e=>"broken_links"!==e.id))};a("badChecks",r.badChecks),a("fairChecks",r.fairChecks),a("suggestionChecks",r.suggestionChecks),a("passedChecks",r.passedChecks),0===s.length?(a("isCheckingLinks",!1),a("linkCheckProgress",{current:0,total:0})):(a("isCheckingLinks",!0),a("linkCheckProgress",{current:0,total:s.length}),await(async(e,t,a,n,s,r,l)=>{const i=a.length,c=[];for(const o of e){let e=!1;try{(await _e({postId:t,userAgent:window.navigator.userAgent,url:o,allLinks:a})).success||(e=!0)}catch{e=!0}n((t=>{const a=new Set(t.checkedLinks),n=new Set(t.brokenLinks);return a.add(o),e&&(n.add(o),c.push(o)),s("linkCheckProgress",{current:a.size,total:i}),{...t,checkedLinks:a,brokenLinks:n}}))}n((e=>{const t={badChecks:l.badChecks.filter((e=>"broken_links"!==e.id)),fairChecks:l.fairChecks.filter((e=>"broken_links"!==e.id)),suggestionChecks:l.suggestionChecks.filter((e=>"broken_links"!==e.id)),passedChecks:l.passedChecks.filter((e=>"broken_links"!==e.id))};return c.length>0&&t.badChecks.push({id:"broken_links",title:(0,b.__)("One or more broken links found on the page.","surerank"),data:[(0,b.__)("These broken links were found on the page:","surerank"),{list:[...c]}]}),s("badChecks",t.badChecks),s("fairChecks",t.fairChecks),s("suggestionChecks",t.suggestionChecks),s("passedChecks",t.passedChecks),s("isCheckingLinks",!1),s("linkCheckProgress",{current:i,total:i}),{...e,isChecking:!1}}))})(s,l,s,t,a,0,{badChecks:r.badChecks,fairChecks:r.fairChecks,passedChecks:r.passedChecks,suggestionChecks:r.suggestionChecks}))}catch(i){m.o.error(i.message),t({isChecking:!1,checkedLinks:new Set,brokenLinks:new Set,allLinks:[]}),a("isCheckingLinks",!1),a("linkCheckProgress",{current:0,total:0})}finally{e(!1)}},ye=()=>"undefined"!==typeof window&&"undefined"!==typeof window.elementor&&window.elementor.hasOwnProperty("elements"),ve=({isRefreshing:e,isChecking:t,onClick:a})=>(0,n.createElement)(g.A,{variant:"outline",size:"xs",onClick:a,disabled:e||t,icon:(0,n.createElement)(be.A,{className:(0,o.cn)("size-4",(e||t)&&"animate-spin")})},(0,b.__)(e||t?"Refreshing":"Refresh","surerank"));var we=a(55300);const xe=({onOpenChecks:e})=>{const{status:t,initializing:a,counts:s}=(()=>{const{setPageSeoCheck:e}=(0,i.useDispatch)(c.E),{metaData:t,variables:a,postDynamicData:n,globalDefaults:s,pageSeoChecks:r,settingsLoaded:o}=(0,i.useSelect)((e=>{const t=e(c.E);return{metaData:t?.getPostSeoMeta()||{},variables:t?.getVariables()||{},postDynamicData:t?.getPostDynamicData()||{},globalDefaults:t?.getGlobalDefaults()||{},pageSeoChecks:t?.getPageSeoChecks()||{},settingsLoaded:t?.getMetaboxState()}}),[]),{badChecks:u,fairChecks:p,passedChecks:m,suggestionChecks:d,initializing:g}=r,[,h]=(0,l.useTransition)(),k=(0,l.useRef)({postContent:"",permalink:""}),f=(0,l.useRef)(t),_=ye(),E=(0,l.useMemo)((()=>A(a)),[a]),y=(0,l.useMemo)((()=>(0,S.A)(t.page_title||s.page_title||"",E,n)),[t.page_title,s.page_title,E,n]),v=(0,l.useMemo)((()=>(0,S.A)(t.page_description||s.page_description||"",E,n)),[t.page_description,s.page_description,E,n]),w=(0,l.useMemo)((()=>(0,S.A)(t.canonical_url||s.canonical_url||"",E,n)),[t.canonical_url,s.canonical_url,E,n]),x=(0,l.useCallback)((async(t,n,s,r,l)=>{if("1"===surerank_seo_popup?.is_taxonomy)return e("checks",[ce(t.permalink),ue(s),pe(r),fe(l)]);const i=(c=t.postContent,(new DOMParser).parseFromString(c,"text/html"));var c;const o=await Promise.all([await re(i),await le(i),ie(i),ce(t.permalink),ue(s),pe(r),me(),oe(i),fe(l)]);e("checks",[...o]),h((async()=>{const t=await(async(e,t,a=window.navigator.userAgent,n)=>{if(!e||!t)return;const s=(e=>{if(!e)return[];const t=Array.from(e.querySelectorAll("a[href]")).map((e=>{if("a"===e.tagName.toLowerCase()){let t=e.getAttribute("href");if(!t.startsWith("http")){const e=(t.startsWith("/")?"":"/")+t;t=`${surerank_globals.site_url}${e}`}return t}return null}));return Array.from(new Set(t.filter((e=>e&&!e.startsWith("#")&&!e.toLowerCase().startsWith("javascript:")))))})(e);if(!s.length)return;const r=await(async({links:e,postId:t,userAgent:a,onProgress:n})=>{if((e=>{if(!e?.length)return he.clear();Array.from(he.keys()).forEach((t=>{e.includes(t)||he.delete(t)}))})(e),!e.length)return[];const s=e.filter((e=>!he.has(e))),r=ke(e);if(0===s.length)return r;const l=s.length;let i=0;return"function"===typeof n&&(n("isCheckingLinks",!0),n("linkCheckProgress",{current:0,total:l})),await Promise.allSettled(s.map((async s=>{try{const n=await _e({postId:t,userAgent:a,url:s,allLinks:e});he.set(s,!!n.success)}catch(r){he.set(s,!1)}i++,"function"===typeof n&&n("linkCheckProgress",{current:i,total:l})}))),n("isCheckingLinks",!1),ke(e)})({links:s,postId:t,userAgent:a,onProgress:n});return ne(r.length?{id:"broken_links",title:(0,b.__)("One or more broken links found on the page.","surerank"),status:"error",data:r}:{id:"broken_links",title:(0,b.__)("No broken links found on the page.","surerank"),status:"success",description:[]})})(i,a?.post?.ID?.value||0,void 0,e);e("checks",[...o,t])}))}),[]);(0,l.useLayoutEffect)((()=>{!_&&o&&g&&(async()=>{const a=Te();await x(a,t,y,v,w),k.current=a,g&&e("initializing",!1)})()}),[_,g,t,y,v,w,o]),(0,l.useLayoutEffect)((()=>{if(_||!o||g)return;const e=(0,ae.debounce)((async()=>{const e=Te();(0,ae.isEqual)(k.current,e)&&(0,ae.isEqual)(f.current,t)||(k.current=e,f.current=t,await x(e,t,y,v,w))}),300),a=(0,i.subscribe)(e);return()=>{a(),e.cancel()}}),[_,t,y,v,x,w,g,o]);const C=(0,l.useMemo)((()=>u.length>0?"error":p.length>0?"warning":d.length>0?"suggestion":"success"),[u,p,d,m]),N=(0,l.useMemo)((()=>({errorAndWarnings:u.length+p.length+d.length})),[u,p,d]);return{status:C,initializing:g,counts:N}})(),{setPageSeoCheck:r}=(0,i.useDispatch)(c.E);return!ye()&&a?(0,n.createElement)(H.A,{className:"size-[2.0625rem]"}):(0,n.createElement)(C.$w,{content:(0,n.createElement)(h.E,{size:12,weight:600,color:"inverse"},s.errorAndWarnings>0?(0,b.sprintf)((0,b.__)("%1$s %2$s need attention. Click to see","surerank"),s.errorAndWarnings,(0,b._n)("issue","issues",s.errorAndWarnings,"surerank")):(0,b.__)("All SEO checks passed. Click to see","surerank")),offset:{crossAxis:-100,mainAxis:8},arrow:!0},(0,n.createElement)(g.A,{variant:"ghost",size:"sm",onClick:()=>{const t="1"===window?.surerank_seo_popup?.is_taxonomy;r("checkType",t?"taxonomy":"post"),t&&window?.surerank_seo_popup?.term_id&&r("postId",window?.surerank_seo_popup?.term_id),e()},icon:(0,n.createElement)(we.A,null),className:(0,o.cn)("border-0.5 border-solid focus:[box-shadow:none] focus:outline-none","error"===t&&"bg-badge-background-red hover:bg-badge-background-red border-badge-border-red text-badge-color-red","warning"===t&&"bg-badge-background-yellow hover:bg-badge-background-yellow border-badge-border-yellow text-badge-color-yellow","success"===t&&"bg-badge-background-green hover:bg-badge-background-green border-badge-border-green text-badge-color-green")}))},Ce=({onClose:e,onOpenChecks:t})=>(0,n.createElement)("div",{className:"flex items-center justify-between gap-10 p-2"},(0,n.createElement)("span",{className:"inline-flex"},(0,n.createElement)(G.uw,{className:"w-32 h-5"})),(0,n.createElement)("div",{className:"inline-flex items-center justify-end gap-2"},(0,n.createElement)(xe,{onOpenChecks:t}),(0,n.createElement)(g.A,{variant:"ghost",size:"sm",onClick:e,className:"p-1 text-icon-secondary hover:text-icon-primary hover:bg-transparent bg-transparent focus:outline-none",icon:(0,n.createElement)(te.A,null)})));var Ne=a(87096),Se=a(62220);const Ae=async()=>{const e=new URLSearchParams;(0,o.P$)("term.php")?e.append("term_id",surerank_seo_popup?.term_id):e.append("post_id",surerank_seo_popup?.post_id),e.append("post_type",surerank_seo_popup?.post_type),e.append("is_taxonomy",surerank_seo_popup?.is_taxonomy);try{const t=await ge()({path:`${(0,o.P$)("term.php")?Se.EJ:Se.MF}?${e.toString()}`,method:"GET"});if(!t.success)throw new Error(t.message);return t}catch(t){throw new Error(t.message)}},De=()=>{const e=(0,i.useSelect)((e=>e(c.E).getUnsavedMetaSettings()),[]),{resetUnsavedMetaSettings:t,initMetaDataAndDefaults:a}=(0,i.useDispatch)(c.E),s=(0,l.useCallback)((e=>{e.preventDefault(),e.returnValue=null}),[e]);(0,l.useEffect)((()=>{if(e&&Object.keys(null!==e&&void 0!==e?e:{}).length)return window.addEventListener("beforeunload",s),()=>{window.removeEventListener("beforeunload",s)}}),[s]);const r=Object.keys(null!==e&&void 0!==e?e:{}).length>0;return(0,n.createElement)(Ne.A,{onClick:async()=>{const n={metaData:e,...(0,o.P$)("term.php")?{term_id:surerank_seo_popup?.term_id}:{post_id:surerank_seo_popup?.post_id}};try{const e=await ge()({path:(0,o.P$)("term.php")?Se.EJ:Se.MF,method:"POST",data:n});if(!e.success)throw e;return(async()=>{try{const e=await Ae();a({postSeoMeta:e.data,globalDefaults:e.global_default})}catch(e){}})(),setTimeout((()=>{t()}),1e3),e}catch(s){throw s}},className:r?"":"opacity-60 bg-background-brand cursor-not-allowed pointer-events-none",icon:r?(0,n.createElement)(G.Zy,null):null})},Pe=({onClose:e})=>(0,n.createElement)("div",{className:"p-2 flex items-center justify-start gap-3"},(0,n.createElement)(De,null),(0,n.createElement)(g.A,{onClick:e,variant:"outline"},(0,b.__)("Close","surerank")));var Me=a(90232);const Le=({isRefreshing:e,isChecking:t,onClick:a,targetSelector:s=".refresh-button-container"})=>{const[r,i]=(0,l.useState)(null);return(0,l.useEffect)((()=>{const e=()=>{const e=document.querySelector(s);e&&i(e)};e();const t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,a=t?new t(e):null;return a&&a.observe(document.body,{childList:!0,subtree:!0}),()=>a.disconnect()}),[s]),r?(0,l.createPortal)((0,n.createElement)(ve,{isRefreshing:e,isChecking:t,onClick:a}),r):null},ze={open:{x:0},closed:{x:"100%"}},Oe={checks:{title:(0,b.__)("Page SEO Checks","surerank"),component:()=>{const{pageSeoChecks:e}=(0,i.useSelect)((e=>{const t=e(c.E);return{pageSeoChecks:t?.getPageSeoChecks()||{}}}),[]);return(0,n.createElement)(_.A,{pageSeoChecks:e})},elementorComponent:()=>{const e=(0,i.useSelect)((e=>e(c.E).getPageSeoChecks()),[]),t=(0,i.useSelect)((e=>e(c.E).getModalState()),[]),a=(0,i.useSelect)((e=>e(c.E).getRefreshCalled()),[]),{setPageSeoCheck:s,setRefreshCalled:r}=(0,i.useDispatch)(c.E),[o,u]=(0,l.useState)({isChecking:!1,checkedLinks:new Set,brokenLinks:new Set,allLinks:[]}),[p,m]=(0,l.useState)(!1),d=ye(),g=(0,l.useCallback)((async()=>{r(!0),await Ee(m,u,s,i.select)}),[m,u,s,e,o,r]);return(0,l.useEffect)((()=>{d&&t&&!a&&(Ee(m,u,s,i.select),r(!0))}),[d,t,a,s,e,o,r]),(0,n.createElement)("div",{className:"p-1 space-y-2 flex-1 flex flex-col"},d&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(Le,{isRefreshing:p,isChecking:o.isChecking,onClick:g}),(0,n.createElement)("div",{className:"p-2"},(0,n.createElement)(z.A,{variant:"info",content:(0,b.__)("Please save changes in the editor before refreshing the checks.","surerank"),className:"shadow-none"}))),(0,n.createElement)("div",{className:"flex-1 overflow-y-auto"},(0,n.createElement)(_.A,{pageSeoChecks:{...e,isCheckingLinks:o.isChecking,linkCheckProgress:{current:o.checkedLinks.size,total:o.allLinks.length}}})))}},settings:{title:(0,b.__)("Settings","surerank"),component:ee}},Te=()=>{const e=(0,i.select)("core/editor"),t=(0,i.select)(c.E);if(e&&"function"===typeof e.getEditedPostContent)return{postContent:e.getEditedPostContent()||"",permalink:e.getPermalink()||surerank_seo_popup?.link,title:e.getEditedPostAttribute("title")||"",description:t.getPostSeoMeta()?.page_description||""};if("undefined"!==typeof window.tinymce&&window.tinymce.get("content")){const e=document.getElementById("title");return{postContent:window.tinymce.get("content").getContent()||"",permalink:surerank_seo_popup?.link,title:e&&e.value||"",description:t.getPostSeoMeta()?.page_description||""}}const a=document.getElementById("content"),n=document.getElementById("title");return{postContent:a&&a.value||"",permalink:surerank_seo_popup?.link,title:n&&n.value||"",description:t.getPostSeoMeta()?.page_description||""}};let Re=e=>e;"block"===surerank_seo_popup?.editor_type?Re=k:"classic"===surerank_seo_popup?.editor_type&&(Re=f);const $e=(0,r.compose)((0,i.withSelect)((e=>{const t=e(c.E);return{initialized:t.getMetaboxState(),appSettings:t.getAppSettings()}})),(0,i.withDispatch)((e=>{const t=e(c.E);return{setMetaDataAndDefaults:e=>t.initMetaDataAndDefaults(e),setInitialized:e=>t.updateMetaboxState(e),updateModalState:e=>t.updateModalState(e),updateAppSettings:e=>t.updateAppSettings(e)}})),Re)((e=>{const{setMetaDataAndDefaults:t,initialized:a,setInitialized:s,updateModalState:r,updateAppSettings:k,appSettings:f}=e,_=(0,i.useSelect)((e=>e(c.E).getModalState()),[]),b=(0,l.useRef)(!1),E=(0,l.useCallback)((async()=>{if(!a)try{const e=await Ae();m.o.success(e.message),t({postSeoMeta:e.data,globalDefaults:e.global_default}),(0,i.dispatch)(c.E).updatePostDynamicData({content:e.data.auto_description})}catch(e){m.o.error(e.message)}finally{s(!0)}}),[a]);(0,l.useEffect)((()=>{b.current||(E(),b.current=!0)}),[E]);const y=(0,l.useCallback)((()=>{setTimeout((()=>{r(!1),(0,i.dispatch)("core/edit-post")?.closeGeneralSidebar("surerank-menu-icon")}),100)}),[r]),v=(0,l.useCallback)((()=>{const{currentScreen:e=""}=f;"checks"!==e&&k({currentScreen:"checks",previousScreen:e})}),[k,f]),w=ye(),x=(0,l.useMemo)((()=>{var e;const t=Oe[null!==(e=f?.currentScreen)&&void 0!==e?e:"settings"];return w&&t?.elementorComponent||t?.component}),[f?.currentScreen,w]);return(0,n.createElement)(l.Fragment,null,(0,n.createElement)(d.Ay,{className:"z-[100000]"}),(0,n.createElement)(u.N,null,_&&(0,n.createElement)(p.P.div,{tabIndex:"0",id:"surerank-seo-popup-modal-container",className:(0,o.cn)("fixed inset-y-0 right-0 lg:w-slide-over-container md:w-slide-over-container w-full z-[99999] bg-background-primary shadow-2xl p-3 flex flex-col gap-2"),initial:"closed",animate:"open",exit:"closed",variants:ze,transition:{duration:.3}},(0,n.createElement)(Ce,{onClose:y,onOpenChecks:v}),f?.previousScreen&&(0,n.createElement)("div",{className:"space-y-2"},(0,n.createElement)("div",{className:"flex items-center justify-between gap-2 pr-3"},(0,n.createElement)("div",{className:"py-1 px-1.5"},(0,n.createElement)(g.A,{onClick:()=>k({currentScreen:f.previousScreen,previousScreen:""}),variant:"ghost",size:"sm",icon:(0,n.createElement)(Me.A,null)},(0,n.createElement)(h.E,{size:14,weight:600},Oe[f?.currentScreen]?.title))),"checks"===f.currentScreen&&w&&(0,n.createElement)("div",{className:"refresh-button-container"}))),(0,n.createElement)("div",{className:"flex-1 flex flex-col overflow-y-auto"},(0,n.createElement)(x,null)),"settings"===f?.currentScreen&&(0,n.createElement)(Pe,{onClose:y}))))})),Ie=()=>{const e=(0,i.useSelect)((e=>e(c.E).getModalState())),{updateModalState:t}=(0,i.useDispatch)(c.E);return(0,l.useEffect)((()=>{e||t(!0)}),[]),null},je=window.wp.plugins;a(36199),(0,i.select)("core/editor")&&(0,je.registerPlugin)("surerank-page-level-settings",{render:()=>{const e=window?.wp?.editor;if(!e||!e?.PluginSidebar||!e?.PluginSidebarMoreMenuItem)return null;const t=e.PluginSidebar,a=e.PluginSidebarMoreMenuItem;return"function"!==typeof a||"function"!==typeof t?null:(0,n.createElement)(n.Fragment,null,(0,n.createElement)(a,{target:"surerank-menu-icon",icon:(0,n.createElement)(G.bk,null)},(0,b.__)("SureRank Meta Box","surerank")),(0,n.createElement)(t,{isPinnable:!0,icon:(0,n.createElement)(G.bk,null),name:"surerank-menu-icon",title:(0,b.__)("SureRank Meta Box","surerank"),className:"surerank-sidebar"},(0,n.createElement)(Ie,null)))}});const qe=()=>{const{updateModalState:e}=(0,i.useDispatch)(c.E);return(0,l.useEffect)((()=>{const e=document.querySelector("#wpadminbar");e&&(e.style.zIndex="10")}),[]),(0,n.createElement)("button",{className:"inline-flex w-auto h-auto p-1 rounded-full border-0 bg-transparent focus:outline-none outline-none cursor-pointer",type:"button",onClick:()=>e(!0)},(0,n.createElement)(G.CX,{className:"size-6"}))};if("classic"===surerank_seo_popup.editor_type){const e=(()=>{const e=document.querySelector(".wrap > h1");if(e){const t=document.createElement("span");return t.id="seo-popup",e.appendChild(t),t}return null})();e&&(0,s.createRoot)(e).render((0,n.createElement)(qe,null))}document.addEventListener("DOMContentLoaded",(function(){document.querySelector("#surerank-seo-popup")||(document.body.appendChild(document.createElement("div")).id="surerank-seo-popup"),setTimeout((function(){(0,s.createRoot)(document.getElementById("surerank-seo-popup")).render((0,n.createElement)($e,null))}),1e3)}))},93832:e=>{e.exports=window.wp.url}},e=>{e.O(0,[795,878,115,85,359,620,691,426,254,440,584,418,555,123,314,427,789,973,43,732,599,811,160,683,40,634,397,76],(()=>e(e.s=91167))),e.O()}]);